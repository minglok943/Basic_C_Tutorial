# Preprocessor
**preprocessor**: An instruction that takes action before compilation. It may expand source code, include/exclude source code, or optimise code in a particular way.

**preprocessor directives**: Lines which start with `#`, which will be processed by the preprocessor.

### 3 Types of Preprocessor Directives
1. **File Inclusion**  
Tells the compiler to include a file using the `#include` directive.

    - **standard / header file**: files provided by the (standard) library. Contains pre-defined functions like `printf()`. These files are included with `<>`.
    Example: `#include <stdio.h>`
    - **user-defined file**: header files defined/written by the user. It's a good practice to divide up functions into separate files and include only when needed. These files are included with `""`.
    Example: `#include "mylibrary.h"`

2. **Macro**  
Associates a name with a piece of code. During preprocessing, the compiler will replace all encounters of the name with the corresponding code. Macros are defined with the `#define` directive.

	```c
	#define SIZE 5
	
	//  All occurrences of `SIZE` will be replaced by `5`.
	int array[SIZE];
	for (int i = 0; i < SIZE; i++) {
		scanf(" %d", &array[i]);
	}
	for (int i = 0; i < SIZE; i++) { 
	    printf("%d \n", array[i]); 
	}
	```

	Macros can take arguments and can be used like functions.

	```c
	#include <stdio.h>
	
	#define PI 3.14159265
	#define CIRCLE_AREA(r) (r*r*PI)
	
	int main() {
	    float radius = 10.0, area;
	    
	    area = CIRCLE_AREA(radius);
	    printf("Area of the circle : %ld", area);
	    
	    return 0;
	}
	```
  
    Macros can be used to represent long and complicated code to make code more readable
  
    ```C
    #define RANGE 3
    #define X_WITHIN_RANGE (x >= -RANGE)&&(x <= RANGE)
    int x;
  
    int main(){
        x = 2;
        if(X_WITHIN_RANGE)
          printf("x is within plus minus %d", RANGE);
    }
      ```
      
      Macros can also be used to run several short operations
      ```c
      //#define TIMER_UPDATE_DUTY_CYCLE(duty1, duty2, duty3) timer1 = duty1;timer2 = duty2;timer3 = duty3;printf("Timer1=%d, Timer2=%d, Timer3=%d\n", timer1, timer2, timer3);
      //Use \ to continue on next line, this make code more readable
      #define TIMER_UPDATE_DUTY_CYCLE(duty1, duty2, duty3) \
			timer1 = duty1; \
			timer2 = duty2; \
			timer3 = duty3; \
			printf("Timer1=%d, Timer2=%d, Timer3=%d\n", timer1, timer2, timer3);
	int timer1, timer2, timer3;	
	```

3. **Conditional Compilation**  
Tells C to compile a specific portion of the program or to skip compilation of some specific part of the program based on conditions, enclosed with `#ifdef`, and `#endif`.

	```c
	#ifdef macro_name
	    // code to be compiled if a macro named
	    // `macro_name` is defined.
	    // if it's not defined, compiler will just 
	    // skip this chunk of code.
	#endif
	```
	You can also use `#if`,`#elif` and `#else` for conditional compilation.
	
	```c
	#if defined macro_name
	    // code to be compiled if a macro named
	    // `macro_name` is defined.
	#elif defined another_macro
	    // code to be compiled if the macro 
	    // above is not defined.
	    // and a macro named `another_macro` is defined.
	#else
	    // code to be compiled if above two macros
	    // are not defined.
	#endif
	```

